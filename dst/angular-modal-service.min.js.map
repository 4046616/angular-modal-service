{"version":3,"sources":["angular-modal-service.js"],"names":["module","angular","factory","$document","$compile","$controller","$http","$rootScope","$q","$timeout","$templateCache","ModalService","self","this","getTemplate","template","templateUrl","deferred","defer","resolve","cachedTemplate","get","undefined","method","url","cache","then","result","put","data","error","reject","promise","showModal","options","controllerName","controller","controllerAs","modalScope","$new","closeDeferred","inputs","$scope","close","delay","inputName","modalElementTemplate","element","linkFn","modalElement","$element","modalController","appendElement","append","body","modal","scope","$destroy","remove","find"],"mappings":"CAMC,WAEC,YAEA,IAAIA,GAASC,QAAQD,OAAO,yBAE5BA,GAAOE,QAAQ,gBAAiB,YAAa,WAAY,cAAe,QAAS,aAAc,KAAM,WAAY,iBAC/G,SAASC,EAAWC,EAAUC,EAAaC,EAAOC,EAAYC,EAAIC,EAAUC,GAK5E,QAASC,KAEP,GAAIC,GAAOC,KAKPC,EAAc,SAASC,EAAUC,GACnC,GAAIC,GAAWT,EAAGU,OAClB,IAAGH,EACDE,EAASE,QAAQJ,OACZ,IAAGC,EAAa,CAErB,GAAII,GAAiBV,EAAeW,IAAIL,EAClBM,UAAnBF,EACDH,EAASE,QAAQC,GAIjBd,GAAOiB,OAAQ,MAAOC,IAAKR,EAAaS,OAAO,IAC5CC,KAAK,SAASC,GAEbjB,EAAekB,IAAIZ,EAAaW,EAAOE,MACvCZ,EAASE,QAAQQ,EAAOE,QAJ5BvB,SAMS,SAASwB,GACdb,EAASc,OAAOD,SAItBb,GAASc,OAAO,iDAElB,OAAOd,GAASe,QAGlBpB,GAAKqB,UAAY,SAASC,GAGxB,GAAIjB,GAAWT,EAAGU,QAGdiB,EAAiBD,EAAQE,UAC7B,OAAID,IAODD,EAAQG,eACTF,EAAiBA,EAAiB,OAASD,EAAQG,cAIrDvB,EAAYoB,EAAQnB,SAAUmB,EAAQlB,aACnCU,KAAK,SAASX,GAGb,GAAIuB,GAAa/B,EAAWgC,OAQxBC,EAAgBhC,EAAGU,QACnBuB,GACFC,OAAQJ,EACRK,MAAO,SAAShB,EAAQiB,IACTtB,SAAVsB,GAAiC,OAAVA,KAAgBA,EAAQ,GAClDnC,EAAS,WACP+B,EAAcrB,QAAQQ,IACrBiB,IAKP,IAAGV,EAAQO,OACT,IAAI,GAAII,KAAaX,GAAQO,OAC3BA,EAAOI,GAAaX,EAAQO,OAAOI,EAKvC,IAAIC,GAAuB7C,QAAQ8C,QAAQhC,GAIvCiC,EAAS5C,EAAS0C,GAClBG,EAAeD,EAAOV,EAC1BG,GAAOS,SAAWD,CAGlB,IAAIE,GAAkB9C,EAAY8B,EAAgBM,EAI9CP,GAAQkB,cAEVlB,EAAQkB,cAAcC,OAAOJ,GAG7BK,EAAKD,OAAOJ,EAId,IAAIM,IACFnB,WAAYe,EACZK,MAAOlB,EACPS,QAASE,EACTN,MAAOH,EAAcR,QAIvBuB,GAAMZ,MAAMjB,KAAK,WAEfY,EAAWmB,WAEXR,EAAaS,WAGfzC,EAASE,QAAQoC,KApErBzC,SAuES,SAASgB,GACdb,EAASc,OAAOD,KAGbb,EAASe,UAtFdf,EAASc,OAAO,qCACTd,EAASe,UA9CtB,GAAIsB,GAAOnD,EAAUwD,KAAK,OAwI1B,OAAO,IAAIhD","file":"angular-modal-service.min.js","sourcesContent":["//  angularModalService.js\r\n//\r\n//  Service for showing modal dialogs.\r\n\r\n/***** JSLint Config *****/\r\n/*global angular  */\r\n(function() {\r\n\r\n  'use strict';\r\n\r\n  var module = angular.module('angularModalService', []);\r\n\r\n  module.factory('ModalService', ['$document', '$compile', '$controller', '$http', '$rootScope', '$q', '$timeout', '$templateCache',\r\n    function($document, $compile, $controller, $http, $rootScope, $q, $timeout, $templateCache) {\r\n\r\n    //  Get the body of the document, we'll add the modal to this.\r\n    var body = $document.find('body');\r\n\r\n    function ModalService() {\r\n\r\n      var self = this;\r\n\r\n      //  Returns a promise which gets the template, either\r\n      //  from the template parameter or via a request to the\r\n      //  template url parameter.\r\n      var getTemplate = function(template, templateUrl) {\r\n        var deferred = $q.defer();\r\n        if(template) {\r\n          deferred.resolve(template);\r\n        } else if(templateUrl) {\r\n          // check to see if the template has already been loaded\r\n          var cachedTemplate = $templateCache.get(templateUrl);\r\n          if(cachedTemplate !== undefined) {\r\n            deferred.resolve(cachedTemplate);\r\n          }\r\n          // if not, let's grab the template for the first time\r\n          else {\r\n            $http({method: 'GET', url: templateUrl, cache: true})\r\n              .then(function(result) {\r\n                // save template into the cache and return the template\r\n                $templateCache.put(templateUrl, result.data);\r\n                deferred.resolve(result.data);\r\n              })\r\n              .catch(function(error) {\r\n                deferred.reject(error);\r\n              });\r\n          }\r\n        } else {\r\n          deferred.reject(\"No template or templateUrl has been specified.\");\r\n        }\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.showModal = function(options) {\r\n\r\n        //  Create a deferred we'll resolve when the modal is ready.\r\n        var deferred = $q.defer();\r\n\r\n        //  Validate the input parameters.\r\n        var controllerName = options.controller;\r\n        if(!controllerName) {\r\n          deferred.reject(\"No controller has been specified.\");\r\n          return deferred.promise;\r\n        }\r\n\r\n        //  If a 'controllerAs' option has been provided, we change the controller\r\n        //  name to use 'as' syntax. $controller will automatically handle this.\r\n        if(options.controllerAs) {\r\n          controllerName = controllerName + \" as \" + options.controllerAs;\r\n        }\r\n\r\n        //  Get the actual html of the template.\r\n        getTemplate(options.template, options.templateUrl)\r\n          .then(function(template) {\r\n\r\n            //  Create a new scope for the modal.\r\n            var modalScope = $rootScope.$new();\r\n\r\n            //  Create the inputs object to the controller - this will include\r\n            //  the scope, as well as all inputs provided.\r\n            //  We will also create a deferred that is resolved with a provided\r\n            //  close function. The controller can then call 'close(result)'.\r\n            //  The controller can also provide a delay for closing - this is\r\n            //  helpful if there are closing animations which must finish first.\r\n            var closeDeferred = $q.defer();\r\n            var inputs = {\r\n              $scope: modalScope,\r\n              close: function(result, delay) {\r\n                if(delay === undefined || delay === null) delay = 0;\r\n                $timeout(function () {\r\n                  closeDeferred.resolve(result);\r\n                }, delay);\r\n              }\r\n            };\r\n\r\n            //  If we have provided any inputs, pass them to the controller.\r\n            if(options.inputs) {\r\n              for(var inputName in options.inputs) {\r\n                inputs[inputName] = options.inputs[inputName];\r\n              }\r\n            }\r\n\r\n            //  Parse the modal HTML into a DOM element (in template form).\r\n            var modalElementTemplate = angular.element(template);\r\n\r\n            //  Compile then link the template element, building the actual element.\r\n            //  Set the $element on the inputs so that it can be injected if required.\r\n            var linkFn = $compile(modalElementTemplate);\r\n            var modalElement = linkFn(modalScope);\r\n            inputs.$element = modalElement;\r\n\r\n            //  Create the controller, explicitly specifying the scope to use.\r\n            var modalController = $controller(controllerName, inputs);\r\n\r\n\r\n            //  Finally, append the modal to the dom.\r\n            if (options.appendElement) {\r\n              // append to custom append element\r\n              options.appendElement.append(modalElement);\r\n            } else {\r\n              // append to body when no custom append element is specified\r\n              body.append(modalElement);\r\n            }\r\n\r\n            //  We now have a modal object.\r\n            var modal = {\r\n              controller: modalController,\r\n              scope: modalScope,\r\n              element: modalElement,\r\n              close: closeDeferred.promise\r\n            };\r\n\r\n            //  When close is resolved, we'll clean up the scope and element.\r\n            modal.close.then(function(result) {\r\n              //  Clean up the scope\r\n              modalScope.$destroy();\r\n              //  Remove the element from the dom.\r\n              modalElement.remove();\r\n            });\r\n\r\n            deferred.resolve(modal);\r\n\r\n          })\r\n          .catch(function(error) {\r\n            deferred.reject(error);\r\n          });\r\n\r\n        return deferred.promise;\r\n      };\r\n\r\n    }\r\n\r\n    return new ModalService();\r\n  }]);\r\n\r\n}());\r\n"],"sourceRoot":"/source/"}