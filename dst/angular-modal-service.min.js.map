{"version":3,"sources":["angular-modal-service.min.js","angular-modal-service.js"],"names":["module","angular","factory","$animate","$document","$compile","$controller","$http","$rootScope","$q","$templateRequest","$timeout","ModalService","self","this","getTemplate","template","templateUrl","deferred","defer","resolve","then","error","reject","promise","appendChild","parent","child","children","length","enter","showModal","options","controllerName","controller","cleanUpClose","result","closeDeferred","leave","modalElement","closedDeferred","modalScope","$destroy","inputs","close","modal","rootScopeOnClose","scope","$new","$on","$scope","delay","undefined","extend","linkFn","$element","controllerObjBefore","controllerAs","modalController","appendElement","body","element","closed","find"],"mappings":"AAAA;AACA,CCKC,WAEC,YAEA,IAAIA,GAASC,QAAQD,OAAO,yBAE5BA,GAAOE,QAAQ,gBAAiB,WAAY,YAAa,WAAY,cAAe,QAAS,aAAc,KAAM,mBAAoB,WACnI,SAASC,EAAUC,EAAWC,EAAUC,EAAaC,EAAOC,EAAYC,EAAIC,EAAkBC,GAK9F,QAASC,KAEP,GAAIC,GAAOC,KAKPC,EAAc,SAASC,EAAUC,GACnC,GAAIC,GAAWT,EAAGU,OAalB,OAZIH,GACFE,EAASE,QAAQJ,GACRC,EACTP,EAAiBO,GAAa,GAC3BI,KAAK,SAASL,GACbE,EAASE,QAAQJ,IAChB,SAASM,GACVJ,EAASK,OAAOD,KAGpBJ,EAASK,OAAO,kDAEXL,EAASM,SAMdC,EAAc,SAASC,EAAQC,GACjC,GAAIC,GAAWF,EAAOE,UACtB,OAAIA,GAASC,OAAS,EACb1B,EAAS2B,MAAMH,EAAOD,EAAQE,EAASA,EAASC,OAAS,IAE3D1B,EAAS2B,MAAMH,EAAOD,GAG/Bb,GAAKkB,UAAY,SAASC,GAGxB,GAAId,GAAWT,EAAGU,QAGdc,EAAiBD,EAAQE,UAC7B,OAAKD,IAMLlB,EAAYiB,EAAQhB,SAAUgB,EAAQf,aACnCI,KAAK,SAASL,GAgEb,QAASmB,GAAaC,GAGpBC,EAAcjB,QAAQgB,GAGtBjC,EAASmC,MAAMC,GACNlB,KAAK,WAEJmB,EAAepB,QAAQgB,GAGvBK,EAAWC,WAKXC,EAAOC,MAAQ,KACf1B,EAAW,KACXmB,EAAgB,KAChBQ,EAAQ,KACRF,EAAS,KACTJ,EAAe,KACfE,EAAa,OAIvBK,GAAoBA,IAxFtB,GAAIL,IAAcT,EAAQe,OAASvC,GAAYwC,OAC3CF,EAAmBtC,EAAWyC,IAAI,yBAA0Bd,GAQ5DE,EAAgB5B,EAAGU,QACnBqB,EAAiB/B,EAAGU,QACpBwB,GACFO,OAAQT,EACRG,MAAO,SAASR,EAAQe,GACRC,SAAVD,GAAiC,OAAVA,IAAgBA,EAAQ,GACnDxC,EAAS,WAEPwB,EAAaC,IAEZe,IAKHnB,GAAQW,QAAQ1C,QAAQoD,OAAOV,EAAQX,EAAQW,OAInD,IAAIW,GAASjD,EAASW,GAClBuB,EAAee,EAAOb,EAC1BE,GAAOY,SAAWhB,CAGlB,IAAIiB,GAAsBf,EAAWT,EAAQyB,cACzCC,EAAkBpD,EAAY0B,EAAQE,WAAYS,GAAQ,EAAOX,EAAQyB,aAEzEzB,GAAQyB,cAAgBD,GAC1BvD,QAAQoD,OAAOK,EAAiBF,GAI9BxB,EAAQ2B,cAEVlC,EAAYO,EAAQ2B,cAAepB,GAGnCd,EAAYmC,EAAMrB,EAIpB,IAAIM,IACFX,WAAYwB,EACZX,MAAON,EACPoB,QAAStB,EACTK,MAAOP,EAAcb,QACrBsC,OAAQtB,EAAehB,QAIzBN,GAASE,QAAQyB,KAiClBxB,KAAK,KAAM,SAASC,GACnBJ,EAASK,OAAOD,KAGbJ,EAASM,UAzGdN,EAASK,OAAO,qCACTL,EAASM,UA9CtB,GAAIoC,GAAOxD,EAAU2D,KAAK,OA2J1B,OAAO,IAAInD","file":"angular-modal-service.min.js","sourcesContent":["/*angular-modal-service v0.6.10 - https://github.com/dwmkerr/angular-modal-service */\n!function(){\"use strict\";var e=angular.module(\"angularModalService\",[]);e.factory(\"ModalService\",[\"$animate\",\"$document\",\"$compile\",\"$controller\",\"$http\",\"$rootScope\",\"$q\",\"$templateRequest\",\"$timeout\",function(e,n,l,o,t,r,c,a,u){function i(){var n=this,t=function(e,n){var l=c.defer();return e?l.resolve(e):n?a(n,!0).then(function(e){l.resolve(e)},function(e){l.reject(e)}):l.reject(\"No template or templateUrl has been specified.\"),l.promise},i=function(n,l){var o=n.children();return o.length>0?e.enter(l,n,o[o.length-1]):e.enter(l,n)};n.showModal=function(n){var a=c.defer(),p=n.controller;return p?(t(n.template,n.templateUrl).then(function(t){function p(n){m.resolve(n),console.log(\"animate : \",e.leave),e.leave(g).then(function(){v.resolve(n),f.$destroy(),$.close=null,a=null,m=null,b=null,$=null,g=null,f=null}),d&&d()}var f=(n.scope||r).$new(),d=r.$on(\"$locationChangeSuccess\",p),m=c.defer(),v=c.defer(),$={$scope:f,close:function(e,n){void 0!==n&&null!==n||(n=0),u(function(){p(e)},n)}};n.inputs&&angular.extend($,n.inputs);var h=l(t),g=h(f);$.$element=g;var j=f[n.controllerAs],S=o(n.controller,$,!1,n.controllerAs);n.controllerAs&&j&&angular.extend(S,j),n.appendElement?i(n.appendElement,g):i(s,g);var b={controller:S,scope:f,element:g,close:m.promise,closed:v.promise};a.resolve(b)}).then(null,function(e){a.reject(e)}),a.promise):(a.reject(\"No controller has been specified.\"),a.promise)}}var s=n.find(\"body\");return new i}])}();\n//# sourceMappingURL=angular-modal-service.min.js.map\n","//  angularModalService.js\n//\n//  Service for showing modal dialogs.\n\n/***** JSLint Config *****/\n/*global angular  */\n(function() {\n\n  'use strict';\n\n  var module = angular.module('angularModalService', []);\n\n  module.factory('ModalService', ['$animate', '$document', '$compile', '$controller', '$http', '$rootScope', '$q', '$templateRequest', '$timeout',\n    function($animate, $document, $compile, $controller, $http, $rootScope, $q, $templateRequest, $timeout) {\n\n    //  Get the body of the document, we'll add the modal to this.\n    var body = $document.find('body');\n\n    function ModalService() {\n\n      var self = this;\n\n      //  Returns a promise which gets the template, either\n      //  from the template parameter or via a request to the\n      //  template url parameter.\n      var getTemplate = function(template, templateUrl) {\n        var deferred = $q.defer();\n        if (template) {\n          deferred.resolve(template);\n        } else if (templateUrl) {\n          $templateRequest(templateUrl, true)\n            .then(function(template) {\n              deferred.resolve(template);\n            }, function(error) {\n              deferred.reject(error);\n            });\n        } else {\n          deferred.reject(\"No template or templateUrl has been specified.\");\n        }\n        return deferred.promise;\n      };\n\n      //  Adds an element to the DOM as the last child of its container\n      //  like append, but uses $animate to handle animations. Returns a\n      //  promise that is resolved once all animation is complete.\n      var appendChild = function(parent, child) {\n        var children = parent.children();\n        if (children.length > 0) {\n          return $animate.enter(child, parent, children[children.length - 1]);\n        }\n        return $animate.enter(child, parent);\n      };\n\n      self.showModal = function(options) {\n\n        //  Create a deferred we'll resolve when the modal is ready.\n        var deferred = $q.defer();\n\n        //  Validate the input parameters.\n        var controllerName = options.controller;\n        if (!controllerName) {\n          deferred.reject(\"No controller has been specified.\");\n          return deferred.promise;\n        }\n\n        //  Get the actual html of the template.\n        getTemplate(options.template, options.templateUrl)\n          .then(function(template) {\n\n            //  Create a new scope for the modal.\n            var modalScope = (options.scope || $rootScope).$new();\n            var rootScopeOnClose = $rootScope.$on('$locationChangeSuccess', cleanUpClose);\n\n            //  Create the inputs object to the controller - this will include\n            //  the scope, as well as all inputs provided.\n            //  We will also create a deferred that is resolved with a provided\n            //  close function. The controller can then call 'close(result)'.\n            //  The controller can also provide a delay for closing - this is\n            //  helpful if there are closing animations which must finish first.\n            var closeDeferred = $q.defer();\n            var closedDeferred = $q.defer();\n            var inputs = {\n              $scope: modalScope,\n              close: function(result, delay) {\n                if (delay === undefined || delay === null) delay = 0;\n                $timeout(function() {\n\n                  cleanUpClose(result);\n\n                }, delay);\n              }\n            };\n\n            //  If we have provided any inputs, pass them to the controller.\n            if (options.inputs) angular.extend(inputs, options.inputs);\n\n            //  Compile then link the template element, building the actual element.\n            //  Set the $element on the inputs so that it can be injected if required.\n            var linkFn = $compile(template);\n            var modalElement = linkFn(modalScope);\n            inputs.$element = modalElement;\n\n            //  Create the controller, explicitly specifying the scope to use.\n            var controllerObjBefore = modalScope[options.controllerAs];\n            var modalController = $controller(options.controller, inputs, false, options.controllerAs);\n\n            if (options.controllerAs && controllerObjBefore) {\n              angular.extend(modalController, controllerObjBefore);\n            }\n\n            //  Finally, append the modal to the dom.\n            if (options.appendElement) {\n              // append to custom append element\n              appendChild(options.appendElement, modalElement);\n            } else {\n              // append to body when no custom append element is specified\n              appendChild(body, modalElement);\n            }\n\n            //  We now have a modal object...\n            var modal = {\n              controller: modalController,\n              scope: modalScope,\n              element: modalElement,\n              close: closeDeferred.promise,\n              closed: closedDeferred.promise\n            };\n\n            //  ...which is passed to the caller via the promise.\n            deferred.resolve(modal);\n\n            function cleanUpClose(result) {\n\n              //  Resolve the 'close' promise.\n              closeDeferred.resolve(result);\n\n              //  Let angular remove the element and wait for animations to finish.\n              $animate.leave(modalElement)\n                      .then(function () {\n                        //  Resolve the 'closed' promise.\n                        closedDeferred.resolve(result);\n\n                        //  We can now clean up the scope\n                        modalScope.$destroy();\n\n                        //  Unless we null out all of these objects we seem to suffer\n                        //  from memory leaks, if anyone can explain why then I'd\n                        //  be very interested to know.\n                        inputs.close = null;\n                        deferred = null;\n                        closeDeferred = null;\n                        modal = null;\n                        inputs = null;\n                        modalElement = null;\n                        modalScope = null;\n                      });\n\n              // remove event watcher\n              rootScopeOnClose && rootScopeOnClose();\n            }\n\n          })\n          .then(null, function(error) { // 'catch' doesn't work in IE8.\n            deferred.reject(error);\n          });\n\n        return deferred.promise;\n      };\n\n    }\n\n    return new ModalService();\n  }]);\n\n}());\n"],"sourceRoot":"/source/"}